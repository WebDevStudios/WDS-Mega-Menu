!function(global){"use strict";function WDS_Mega_Menu(){if(WDS_Mega_Menu.prototype._singleton)return WDS_Mega_Menu.prototype._singleton;WDS_Mega_Menu.prototype._singleton=this;var me=this;this.renderMediaUploader=function(element_id){var file_frame;return me.target_element=element_id,void 0!==file_frame?void file_frame.open():(file_frame=wp.media.frames.file_frame=wp.media({frame:"post",state:"insert",multiple:!1}),file_frame.on("insert",me.insert_image),void file_frame.open())},this.resetUploadForm=function(element_id){$("#menu-item-image-container-"+element_id).children("img").hide(),$("#menu-item-image-container-"+element_id).prev().show(),$("#menu-item-image-container-"+element_id).next().hide().addClass("hidden"),jQuery("#menu-item-image-"+element_id).val("")},this.renderFeaturedImage=function(element_id){0<$.trim($("#menu-item-image-"+element_id).val()).length&&($("#menu-item-image-container-"+element_id).removeClass("hidden"),$("#set-menu-item-image-"+element_id).parent().hide(),$("#remove-menu-item-image-"+element_id).parent().removeClass("hidden"))},this.insert_image=function(){var file_frame=wp.media.frames.file_frame,json=file_frame.state().get("selection").first().toJSON();0>jQuery.trim(json.url.length)||(jQuery("#menu-item-image-container-"+me.target_element).children("img").attr({src:json.url,alt:json.caption,title:json.title}).show().parent().removeClass("hidden"),jQuery("#menu-item-image-"+me.target_element).val(json.id),jQuery("#menu-item-image-container-"+me.target_element).prev().hide(),jQuery("#menu-item-image-container-"+me.target_element).next().show())},this.initEditMenu=function(){if(global.hasOwnProperty("WDS_MegaMenu_Loc"))for(var key in global.WDS_MegaMenu_Loc.featured_ids)global.WDS_MegaMenu_Loc.featured_ids.hasOwnProperty(key)&&registerMenuButton(parseInt(global.WDS_MegaMenu_Loc.featured_ids[key],10))},this.initOptionsPage=function(){registerOptionsControls()}}function registerMenuButton(id){WDS.MegaMenu.renderFeaturedImage(id),$("#set-menu-item-image-"+id).on("click",function(e){e.preventDefault(),WDS.MegaMenu.renderMediaUploader(id)}),$("#remove-menu-item-image-"+id).on("click",function(evt){evt.preventDefault(),WDS.MegaMenu.resetUploadForm(id)})}function registerOptionsControls(){var $all_depths=$("#all_depths"),$depth_input_last=$(".depth_options li:not(:last-child) input");$all_depths.length&&$all_depths.change(function(){this.checked&&$(".depth_options").find("li:not(:last-child) input").attr({checked:"checked"})}),$depth_input_last.length&&$($depth_input_last).change(function(){$all_depths.removeAttr("checked")})}var $=$||jQuery;global.WDS=global.WDS||{},global.WDS.MegaMenu=new WDS_Mega_Menu,$(document).ready(global.WDS.MegaMenu.initEditMenu),$(document).ready(global.WDS.MegaMenu.initOptionsPage)}(window);